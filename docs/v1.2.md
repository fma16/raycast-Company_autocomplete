# Plan de Développement v1.2: Template de Réponse Personnalisable

## 1. Objectif

Permettre aux utilisateurs de définir un template personnalisé pour le formatage de la sortie des détails d'une entreprise. Cela offrira une plus grande flexibilité pour adapter l'extension aux besoins spécifiques de chacun.

## 2. Schéma de la Fonctionnalité

### a. Préférences Utilisateur

-   **Action :** Ajouter une nouvelle préférence dans le fichier `package.json`.
-   **Type :** `textarea` pour permettre un contenu sur plusieurs lignes.
-   **Nom :** `outputTemplate`
-   **Label :** "Output Template"
-   **Description :** "Define your custom output template. Use {{variable}} for placeholders. See documentation for available variables."
-   **Défaut :** Nous garderons le format actuel comme template par défaut.

### b. Stockage et Accès

-   Le template sera stocké et géré par Raycast via les préférences.
-   L'accès se fera en utilisant `getPreferenceValues<{ outputTemplate: string }>()` de l'API `@raycast/api`.
-   Un template par défaut sera codé en dur dans `src/services/markdown-builder.ts` et utilisé si la préférence est vide.

### c. Logique de Templating

-   **Service concerné :** `src/services/markdown-builder.ts`
-   **Logique :**
    1.  Récupérer le template depuis les préférences.
    2.  Si le template est vide, utiliser le template par défaut.
    3.  Récupérer les données formatées de l'entreprise.
    4.  Itérer sur les clés des données et remplacer les placeholders correspondants (ex: `{{siren}}`) dans le template par les valeurs réelles.
    5.  Retourner le Markdown final.

## 3. Analyse des Variables Disponibles

Cette étape est cruciale pour la documentation et l'utilité de la fonctionnalité.

-   **Action :**
    1.  Analyser en profondeur les types de données dans `src/types.ts`, notamment `Company`, `FormattedData`, et les sous-objets.
    2.  Effectuer un appel à l'API INPI avec un SIREN connu et analyser la réponse JSON complète pour identifier tous les champs disponibles.
    3.  Dresser une liste exhaustive de toutes les variables possibles (ex: `nom_complet`, `siren`, `siret`, `adresse_complete`, `ville`, `capital_social`, `date_creation`, `nom_representant`, `role_representant`, etc.).
    4.  Cette liste sera ajoutée à la documentation de l'extension (README.md).

## 4. Plan d'Action Séquentiel

1.  **Branche Git :** Créer la branche `v1.2` (fait).
2.  **Analyse des variables :** Effectuer l'étape 3 et documenter les résultats en interne.
3.  **Modification `package.json` :** Ajouter la nouvelle préférence `outputTemplate`.
4.  **Mise à jour du `markdown-builder.ts` :**
    -   Intégrer la lecture des préférences.
    -   Implémenter la logique de remplacement des placeholders.
    -   Définir le template par défaut.
5.  **Mise à jour de la documentation :**
    -   Modifier le `README.md` pour expliquer la nouvelle fonctionnalité.
    -   Ajouter la liste complète des variables de template disponibles.
6.  **Tests :**
    -   Tester le cas par défaut (sans template personnalisé).
    -   Tester avec un template personnalisé simple.
    -   Tester avec un template complexe et des variables inexistantes (qui devraient être ignorées).
